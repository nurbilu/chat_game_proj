<!-- profile.component.html -->
<div class="profile-container container">
    <h2 class="text-center my-4">Profile</h2>
    <div *ngIf="!isSuperuser">
        <div class="text-center mb-4">
            <img [src]="profilePictureUrl" class="img-thumbnail profile-picture" alt="Profile Picture">
        </div>
        <div *ngIf="showUpdateForm">
            <form (ngSubmit)="confirmUpdate()" class="update-form">
                <div class="mb-3 input-group">
                    <span class="input-group-text">Username</span>
                    <input type="text" class="form-control" id="username" [(ngModel)]="userProfile.username" name="username">
                </div>
                <div class="mb-3 input-group">
                    <span class="input-group-text">First Name</span>
                    <input type="text" class="form-control" id="first_name" [(ngModel)]="userProfile.first_name" name="first_name">
                </div>
                <div class="mb-3 input-group">
                    <span class="input-group-text">Last Name</span>
                    <input type="text" class="form-control" id="last_name" [(ngModel)]="userProfile.last_name" name="last_name">
                </div>
                <div class="mb-3 input-group">
                    <span class="input-group-text">Email</span>
                    <input type="email" class="form-control" id="email" [(ngModel)]="userProfile.email" name="email">
                </div>
                <div class="mb-3 input-group">
                    <span class="input-group-text">Address</span>
                    <input type="text" class="form-control" id="address" [(ngModel)]="userProfile.address" name="address">
                </div>
                <div class="mb-3 input-group">
                    <span class="input-group-text">Birthdate</span>
                    <input type="date" class="form-control" id="birthdate" [(ngModel)]="userProfile.birthdate" name="birthdate">
                </div>
                <div class="d-flex justify-content-between">
                    <button type="submit" class="btn btn-success">Update Profile</button>
                    <button type="button" (click)="toggleUserDataDisplay()" class="btn btn-secondary">Cancel</button>
                </div>
            </form>
            <form (ngSubmit)="updateProfilePicture()" class="update-form mt-3" enctype="multipart/form-data">
                <div class="mb-3 input-group">
                    <span class="input-group-text">Profile Picture</span>
                    <input type="file" class="form-control" id="profile_picture" (change)="onFileSelected($event)">
                </div>
                <button type="submit" class="btn btn-primary">Update Profile Picture</button>
            </form>
        </div>
        <button *ngIf="!showUpdateForm" (click)="toggleEditMode()" class="btn btn-success my-3">Edit Profile</button>
        <div *ngIf="showUserData" class="user-data table-responsive">
            <table class="table table-striped">
                <tbody>
                    <tr><th>Username</th><td>{{ userProfile?.username }}</td></tr>
                    <tr><th>First Name</th><td>{{ userProfile?.first_name }}</td></tr>
                    <tr><th>Last Name</th><td>{{ userProfile?.last_name }}</td></tr>
                    <tr><th>Email</th><td>{{ userProfile?.email }}</td></tr>
                    <tr><th>Address</th><td>{{ userProfile?.address }}</td></tr>
                    <tr><th>Birthdate</th><td>{{ userProfile?.birthdate }}</td></tr>
                </tbody>
            </table>
        </div>
        <div *ngIf="characters.length > 0" class="characters-list mt-4">
            <h3>Your Characters</h3>
            <ul class="list-group">
                <li *ngFor="let character of characters" class="list-group-item d-flex justify-content-between align-items-center">
                    <span>{{ character.name }} - {{ character.race }} - {{ character.gameStyle }}</span>
                    <button (click)="deleteCharacter(userProfile.username, character.name)" class="btn btn-danger btn-sm">Delete</button>
                </li>
            </ul>
        </div>
    </div>
</div>

<ng-template #successTemplate>
  <div>Operation successful</div>
</ng-template>
<ng-template #errorTemplate>
  <div>Operation failed</div>
</ng-template>